
language: c
dist: focal
matrix:
  fast_finish: true
  sudo: true
  include:
    - script:
        - ./configure --with-target=debug && sudo make wsi
    - script:
        - ./configure --with-target=release && sudo make wsi
    - script:
        - sudo apt update
        - sudo apt install libtcc-dev
        - ./configure --with-target=release --enable-jit && sudo make wsi
    - script:
        - sudo apt update
        - sudo apt install libtcc-dev
        - ./configure --with-target=coverage --enable-jit && sudo make fix-libtcc wsi test
      after_success:
        - bash <(curl -s https://codecov.io/bash)
  cache: apt
